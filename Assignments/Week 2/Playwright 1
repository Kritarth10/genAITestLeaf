///This file is conversion of selenium java code of login into leaftaps into playwright with javascript

const { test, expect } = require('@playwright/test');

/**
 * Page Object Model for Login Page
 */
class LoginPage {
  /**
   * @param {import('@playwright/test').Page} page
   */
  constructor(page) {
    this.page = page;
  }

  /**
   * Navigate to the login page URL
   */
  async navigate() {
    await this.page.goto('http://leaftaps.com/opentaps');
  }

  /**
   * Maximize the browser window by setting viewport to 1920x1080
   */
  async maximizeWindow() {
    await this.page.setViewportSize({ width: 1920, height: 1080 });
  }

  /**
   * Enter username into username input field
   * Use locator priority: name, class, link text, xpath
   */
  async enterUsername(username) {
    // Avoid id with numbers; use name attribute
    await this.page.fill('[name="USERNAME"]', username);
  }

  /**
   * Enter password into password input field
   */
  async enterPassword(password) {
    await this.page.fill('[name="PASSWORD"]', password);
  }

  /**
   * Click on the login button by class name
   */
  async clickLogin() {
    await this.page.click('.decorativeSubmit');
  }
}

test.describe('Login Test Suite', () => {
  let loginPage;

  test.beforeEach(async ({ page }) => {
    loginPage = new LoginPage(page);
    await loginPage.navigate();
    await loginPage.maximizeWindow();
  });

  /**
   * Test to perform login and verify page title after login
   */
  test('Login with valid credentials and verify title', async ({ page }) => {
    await loginPage.enterUsername('DemoSalesManager');
    await loginPage.enterPassword('crmsfa');
    await loginPage.clickLogin();

    await expect(page).toHaveTitle(/Leaftaps/i);
  });
});
